import streamlit as st
from typing import Dict, List

st.set_page_config(page_title="증상별 약 안내", page_icon="🩺", layout="centered")

# ===== 헤더 & 소개 =====
st.title("🩺 증상별로 먹을 수 있는 약 안내")
st.write("증상을 선택하면 **일반의약품(OTC)** 기준의 대표 성분과 예시 제품, 증상 완화 팁을 보여줍니다.")

# 배경 색 (가벼운 하늘색 톤)
st.markdown(
    """
    <style>
      .stApp {background-color: #eaf6ff;}
      .pill {display:inline-block; padding:4px 10px; border-radius:999px; background:#fff; border:1px solid #dbeafe;}
      .tag {display:inline-block; padding:2px 8px; border-radius:6px; border:1px solid #e5e7eb; margin-right:6px; font-size:12px}
      .disclaimer {border-left: 4px solid #2563eb; padding: 12px 16px; background:#f8fbff; border-radius:8px;}
    </style>
    """,
    unsafe_allow_html=True,
)

st.markdown(
    """
    <div class="disclaimer">
    ⚠️ **주의**: 본 앱은 교육·발표용 정보 제공을 위한 참고 자료입니다. 
    실제 복용 전에는 **제품 라벨**과 **약사/의사 상담**을 반드시 확인하세요. 
    임신/수유 중, 기저질환(간/신장/심혈관 등), 복용 중인 약물이 있다면 전문인과 상의가 필요합니다.
    </div>
    """,
    unsafe_allow_html=True,
)

# ===== 데이터: 증상별 권장 성분/예시 제품/생활 팁/위험 신호 =====
SymptomInfo = Dict[str, Dict[str, List[str]]]

symptom_db: SymptomInfo = {
    "두통": {
        "emoji": ["🧠"],
        "성분": [
            "아세트아미노펜 (예: 타이레놀정 500mg, 어린이타이레놀 현탁액)",
            "이부프로펜 (예: 애드빌리퀴-겔, 브루펜)",
        ],
        "팁": [
            "수분 섭취, 조용하고 어두운 곳에서 휴식",
            "카페인 과다 섭취 피하기, 규칙적 수면 유지",
        ],
        "경고": [
            "갑작스런 심한 번개통/가장 심한 두통 경험",
            "열·목 경직·의식 혼미 동반",
            "외상 이후 지속되는 두통",
            "임신 중 또는 소아의 지속 두통",
        ],
    },
    "발열": {
        "emoji": ["🤒"],
        "성분": [
            "아세트아미노펜 (예: 타이레놀)",
            "이부프로펜 (예: 애드빌) — 위장 장애시 주의",
        ],
        "팁": [
            "미지근한 물수건으로 몸 닦기",
            "수분 충분히 섭취, 가벼운 복장",
        ],
        "경고": [
            "성인 39°C 이상 또는 3일 이상 지속",
            "영유아 고열/경련/탈수 징후",
        ],
    },
    "기침": {
        "emoji": ["🤧"],
        "성분": [
            "덱스트로메토르판(진해제) — 만 4세 미만 소아 금기",
            "구아이페네신(거담제)",
        ],
        "팁": [
            "따뜻한 물·꿀차(1세 미만 꿀 금지)",
            "가습·수분 섭취",
        ],
        "경고": [
            "혈담/흑색 가래, 흉통, 호흡곤란",
            "3주 이상 지속되는 만성 기침",
        ],
    },
    "인후통/목통증": {
        "emoji": ["😷"],
        "성분": [
            "염화데카리늄/벤지다민 스프레이/트로키 (예: 스트렙실, 베타딘 가글)",
            "아세트아미노펜 — 동반 통증/발열 완화",
        ],
        "팁": [
            "따뜻한 물 자주 마시기, 자극적 음식 피하기",
            "가습 유지, 충분한 휴식",
        ],
        "경고": [
            "고열과 심한 삼킴곤란/침 흘림",
            "피부발진 동반(예: 성홍열 의심)",
        ],
    },
    "콧물/코막힘": {
        "emoji": ["🌬️"],
        "성분": [
            "로라타딘/세티리진 등 2세대 항히스타민제",
            "비강분무용 국소 혈관수축제(자일로메타졸린) — 3~5일 이내 단기 사용",
            "생리식염수 비강 세척",
        ],
        "팁": [
            "실내 습도 40~60% 유지",
            "따뜻한 수분 섭취",
        ],
        "경고": [
            "안면 통증·고열 동반(부비동염 의심)",
            "8주 이상 지속되는 만성 비염",
        ],
    },
    "소화불량/속쓰림": {
        "emoji": ["🔥"],
        "성분": [
            "제산제(알루미늄/마그네슘 수산화물)",
            "H2 차단제(라니티딘 대체 성분: 파모티딘 등)",
        ],
        "팁": [
            "늦은 야식·기름진 음식 피하기",
            "취침 전 2~3시간 금식, 베개 높이기",
        ],
        "경고": [
            "흑색변/토혈, 체중 감소, 삼킴곤란",
            "지속적·야간 통증",
        ],
    },
    "설사": {
        "emoji": ["🚰"],
        "성분": [
            "경구수분보충용액(ORS)",
            "로페라마이드 — 고열/혈변 시 사용 금지",
            "유산균 제제(보조)",
        ],
        "팁": [
            "수분·전해질 보충, 기름진 음식 피하기",
            "먹는 우유/치즈 일시 제한",
        ],
        "경고": [
            "혈변/고열/심한 복통",
            "영유아·노인의 탈수 징후",
        ],
    },
    "변비": {
        "emoji": ["🌿"],
        "성분": [
            "차전자피(식이섬유)/락툴로오스(삼투성 하제)",
            "도큐세이트(연화제)",
        ],
        "팁": [
            "수분 섭취 늘리기, 규칙적 운동",
            "식이섬유 섭취(야채·통곡물)",
        ],
        "경고": [
            "장폐색 의심(심한 복통·구토·복부팽만)",
            "혈변/체중 감소 동반",
        ],
    },
    "근육통/관절통": {
        "emoji": ["💪"],
        "성분": [
            "이부프로펜/덱시부프로펜, 나프록센",
            "국소 파스(디클로페낙 겔 등)",
        ],
        "팁": [
            "초기 냉찜질, 이후 온찜질",
            "무리한 운동 피하고 가벼운 스트레칭",
        ],
        "경고": [
            "외상 후 움직임 제한/기형",
            "붓기·홍반·열감 심함(감염 의심)",
        ],
    },
    "생리통": {
        "emoji": ["🩸"],
        "성분": [
            "이부프로펜/나프록센",
            "아세트아미노펜(위장 민감 시 대안)",
        ],
        "팁": [
            "온찜질, 가벼운 유산소 운동",
            "카페인·염분 과다 피하기",
        ],
        "경고": [
            "극심한 통증/실신, 비정상적 출혈",
            "갑작스러운 주기 변화",
        ],
    },
    "멀미": {
        "emoji": ["🛳️"],
        "성분": [
            "디멘하이드리네이트(예: 드라마민)",
            "메클리진(국내 일부 제품)",
        ],
        "팁": [
            "출발 30분~1시간 전 복용",
            "차창 밖 먼 곳 보기, 과식 피하기",
        ],
        "경고": [
            "의식 변화·신경학적 증상 동반",
        ],
    },
    "알레르기 비염(재채기/가려움)": {
        "emoji": ["🌸"],
        "성분": [
            "로라타딘/세티리진/펙소페나딘 등 2세대 항히스타민",
            "플루티카손/모메타손 비강 스테로이드 스프레이 — 장기 사용은 전문가 상담",
        ],
        "팁": [
            "원인 회피(환기·청소), 코 세척",
            "외출 시 마스크 착용",
        ],
        "경고": [
            "심한 호흡곤란/천명, 전신 두드러기",
        ],
    },
}

# ===== UI: 증상 선택 =====
symptom_list = ["현재 느끼는 증상을 선택하세요."] + list(symptom_db.keys())
choice = st.selectbox("증상을 선택하세요", symptom_list)

if choice == "현재 느끼는 증상을 선택하세요.":
    st.stop()

info = symptom_db[choice]

# 헤더 섹션
st.subheader(f"{info['emoji'][0]} {choice}")

st.markdown("**권장 성분 & 예시 제품**")
for line in info["성분"]:
    st.markdown(f"- {line}")

st.markdown("\n**증상 완화 팁**")
for tip in info["팁"]:
    st.markdown(f"- {tip}")

with st.expander("🚑 병원 방문이 필요한 경고 신호"):
    for warn in info["경고"]:
        st.markdown(f"- {warn}")

st.info("복용량·횟수·연령 제한은 **제품 포장/설명서** 또는 **약사/의사** 안내를 우선하세요. 특정 성분(예: 이부프로펜)은 위장 질환·신장 질환·임신 3기 등에서 주의가 필요합니다.")
